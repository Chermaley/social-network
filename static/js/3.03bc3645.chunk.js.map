{"version":3,"sources":["component/nav/chat/chatPage.module.scss","component/nav/chat/chatPage.tsx"],"names":["module","exports","ws","WebSocket","ChatPage","Chat","className","classes","chat","Messages","AddMessageForm","useState","messages","setMessages","setMessagesFromApi","e","prevState","JSON","parse","data","useEffect","console","log","addEventListener","map","m","index","Message","message","photo","src","alt","text","setMessage","onChange","target","value","onClick","send"],"mappings":"2FACAA,EAAOC,QAAU,CAAC,KAAO,uBAAuB,SAAW,2BAA2B,QAAU,0BAA0B,MAAQ,0B,4FCE5HC,EAAK,IAAIC,UAAU,gEAgBVC,UANY,WACvB,OACI,cAACC,EAAD,KAOR,IAAMA,EAAiB,WAEnB,OACI,sBAAKC,UAAWC,IAAQC,KAAxB,UACI,cAACC,EAAD,IACA,cAACC,EAAD,QAKND,EAAqB,WAAO,IAAD,EAEGE,mBAA4B,IAF/B,mBAEtBC,EAFsB,KAEZC,EAFY,KAIvBC,EAAqB,SAACC,GACxBF,GAAY,SAAAG,GAAS,4BAAQA,GAAR,YAAsBC,KAAKC,MAAMH,EAAEI,YAQ5D,OALAC,qBAAU,WACNC,QAAQC,IAAI,GACZpB,EAAGqB,iBAAiB,UAAWT,KAChC,IAGC,qBAAKR,UAAWC,IAAQK,SAAxB,SACKA,EAASY,KAAI,SAACC,EAAGC,GACd,OAAO,cAACC,EAAD,CAAqBC,QAASH,GAAhBC,SAO/BC,EAAgD,SAAC,GAAe,IAAdC,EAAa,EAAbA,QACpD,OACI,sBAAKtB,UAAWC,IAAQqB,QAAxB,UACI,qBAAKtB,UAAWC,IAAQsB,MAAxB,SAA+B,qBAAKC,IAAKF,EAAQC,MAAOE,IAAI,gBAC5D,qBAAKzB,UAAWC,IAAQyB,KAAxB,SAA+BJ,EAAQA,cAK7ClB,EAA2B,WAAO,IAAD,EACLC,mBAAS,IADJ,mBAC5BiB,EAD4B,KACnBK,EADmB,KASnC,OACI,gCACI,8BACI,0BAAUC,SAAU,SAACnB,GAAD,OAAOkB,EAAWlB,EAAEoB,OAAOC,QAAQA,MAAOR,MAElE,8BACI,wBAAQS,QAbA,WACXT,IAGL1B,EAAGoC,KAAKV,GACRK,EAAW,MAQH","file":"static/js/3.03bc3645.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"chat\":\"chatPage_chat__UGm6C\",\"messages\":\"chatPage_messages__1rzWI\",\"message\":\"chatPage_message__1KTs_\",\"photo\":\"chatPage_photo__3AVl5\"};","import React, {useEffect, useState} from \"react\";\r\nimport classes from './chatPage.module.scss';\r\n\r\nconst ws = new WebSocket('wss://social-network.samuraijs.com/handlers/ChatHandler.ashx');\r\n\r\nexport type ChatMessageType = {\r\n    message: string,\r\n    photo: string,\r\n    userId: number,\r\n    userName: string\r\n}\r\n\r\n\r\nconst ChatPage: React.FC = () => {\r\n    return (\r\n        <Chat/>\r\n    );\r\n};\r\n\r\nexport default ChatPage;\r\n\r\n\r\nconst Chat: React.FC = () => {\r\n\r\n    return (\r\n        <div className={classes.chat}>\r\n            <Messages/>\r\n            <AddMessageForm/>\r\n        </div>\r\n    );\r\n};\r\n\r\nconst Messages: React.FC = () => {\r\n\r\n    const [messages, setMessages] = useState<ChatMessageType[]>([]);\r\n\r\n    const setMessagesFromApi = (e: any) => {\r\n        setMessages(prevState => [...prevState, ...JSON.parse(e.data)]);\r\n    };\r\n\r\n    useEffect(() => {\r\n        console.log(1);\r\n        ws.addEventListener('message', setMessagesFromApi);\r\n    }, []);\r\n\r\n    return (\r\n        <div className={classes.messages}>\r\n            {messages.map((m, index) => {\r\n                return <Message key={index} message={m} />;\r\n            })}\r\n        </div>\r\n    );\r\n};\r\n\r\n\r\nconst Message: React.FC<{message: ChatMessageType}> = ({message}) => {\r\n    return (\r\n        <div className={classes.message}>\r\n            <div className={classes.photo}><img src={message.photo} alt=\"userPhoto\"/></div>\r\n            <div className={classes.text}>{message.message}</div>\r\n        </div>\r\n    );\r\n};\r\n\r\nconst AddMessageForm: React.FC = () => {\r\n    const [message, setMessage] = useState('');\r\n    const sendMessage = () => {\r\n        if (!message) {\r\n            return;\r\n        }\r\n        ws.send(message);\r\n        setMessage('');\r\n    };\r\n    return (\r\n        <div>\r\n            <div>\r\n                <textarea onChange={(e) => setMessage(e.target.value)} value={message}/>\r\n            </div>\r\n            <div>\r\n                <button onClick={sendMessage}>Send</button>\r\n            </div>\r\n        </div>\r\n    );\r\n};"],"sourceRoot":""}